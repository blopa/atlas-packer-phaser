(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{ckTt:function(l,n,t){"use strict";t.r(n);var a=t("CcnG"),u=function(){},e=t("pMnS"),i=t("Ip0R"),o=t("gIcY"),s=t("db6O"),r=t("m7g1"),c=t("sX7g"),h=t("fDnD"),p=t("JEAp"),g=function(){function l(l,n,t){var a=this;this.localStorage=l,this.animatorService=n,this.router=t,this.imagesFiles=[],this.anims=[],this.actualKey="",this.repeatControl=-1,this.frameRateControl=24,null!=l.get("atlasDB")||void 0!==n.getAtlas()?(this.atlasDB=void 0!==n.getAtlas()?(l.set("atlasDB",n.getAtlas()),n.getAtlas()):l.get("atlasDB"),this.imagesFiles=this.atlasDB[0].spritesheet_array):swal({title:"No se ha agregado ning\xfan spritesheet",text:"No se ha agregado ning\xfan spritesheet y atlas, por favor agregalo",type:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"\xa1Ok!"}).then(function(l){l.value&&a.router.navigate(["/"])})}return l.prototype.ngOnInit=function(){this.phaserCharge()},l.prototype.phaserCharge=function(){$("#container_phaser canvas").remove();var l=this.actualKey,n={name:this.atlasDB[0].name,spritesheet:URL.createObjectURL(b64toBlob(this.atlasDB[0].spritesheet)),atlas:URL.createObjectURL(new Blob([JSON.stringify(this.atlasDB[0].atlas)]))},t=this.anims,a=this.atlasDB[0].spritesheet_array.reduce(function(l,n){return{width:l.width<n[0].width?n[0].width:l.width,height:l.height<n[0].height?n[0].height:l.width}},{width:0,height:0}),u={width:a.width,height:a.height,type:Phaser.CANVAS,parent:"container_phaser",backgroundColor:"#0984e3",pixelArt:!0,scene:{preload:function(){this.load.atlas(n.name,n.spritesheet,n.atlas)},create:function(){console.log("El sis: ",this.sys.game.config);var a=this.add.sprite(this.sys.game.config.width/2,this.sys.game.config.height/2,n.name);if(t.length>0){var u=t.filter(function(n){return n.key===l});u[0].frames.length>0&&(console.log(" este es el actual key frame",l),console.log(" esta es la animacion: ",t),console.log("Animacion de Phaser: ",{anims:u}),this.anims.fromJSON({anims:u}),a.play(l))}}}};new Phaser.Game(u)},l.prototype.addRemoveKey=function(l){var n=this;"add"===l?swal({title:"Key name",input:"text",inputPlaceholder:"Key name"}).then(function(l){l.value&&(n.anims.some(function(n){return n.key===l.value})?swal({title:"El key name ya existe",text:"Ya est\xe1 en uso ese nombre",type:"warning",confirmButtonText:"Ok"}):(n.anims.push({key:clearString(l.value),type:"frames",repeat:-1,frameRate:12,frames:[]}),n.changeActualKey(l.value)))}):"remove"===l&&(this.anims=deleteSpriteInArray(this.actualKey,this.anims),this.actualKey=void 0!==this.anims[this.anims.length-1]?this.anims[this.anims.length-1].key:"",this.updateActualFrames())},l.prototype.changeKeyName=function(l){var n=this;swal({title:"Editor del key name",input:"text",inputPlaceholder:l}).then(function(t){t.value&&(n.anims.some(function(l){return l.key===t.value})?swal({title:"El key name ya existe",text:"Ya est\xe1 en uso ese nombre",type:"warning",confirmButtonText:"Ok"}):(n.anims=Object(c.c)(function(n){return n.key===l&&(n.key=t.value),n},n.anims),n.changeActualKey(t.value)))})},l.prototype.changeActualKey=function(l){this.actualKey=l,this.updateActualFrames()},l.prototype.updateActualFrames=function(){var l=this;this.actualFrames=this.anims.filter(function(n){return n.key===l.actualKey})[0].frames,this.anims.map(function(n){n.key===l.actualKey&&(l.repeatControl=n.repeat,l.frameRateControl=n.frameRate)}),this.phaserCharge()},l.prototype.updateAnimsControls=function(){var l=this;this.anims=this.anims.map(function(n){return n.key===l.actualKey&&(n.repeat=l.repeatControl,n.frameRate=l.frameRateControl),n}),this.phaserCharge()},l.prototype.addSprite=function(l){var n=this;""!==this.actualKey&&void 0!==this.actualKey&&" "!==this.actualKey?(this.anims=this.anims.map(function(t){return t.key===n.actualKey&&t.frames.push({key:n.atlasDB[0].name,frame:l.name,result:l.result}),t}),this.updateActualFrames(),this.phaserCharge()):console.log("No has seleccionado el key")},l.prototype.removeSprite=function(l){this.anims=this.anims.map(function(n){return n.frames=n.frames.filter(function(n){return n.frame!==l}),n}),this.updateActualFrames(),this.phaserCharge()},l.prototype.generateAnim=function(){console.log(this.atlasDB);var l=new h,n=clearString(this.atlasDB[0].name),t=JSON.stringify(this.atlasDB[0].atlas,null,"    "),a=JSON.stringify({anims:this.anims},null,"    ");l.file(n+"_atlas.json",t),l.file(n+"_anim.json",a),l.file(n+".png",this.atlasDB[0].spritesheet.replace("data:image/png;base64,",""),{base64:!0}),l.generateAsync({type:"blob"}).then(function(l){Object(p.saveAs)(l,"PP3.zip")})},l}(),m=t("ZYCi"),d=a.La({encapsulation:0,styles:[[".col-6[_ngcontent-%COMP%]{outline:green solid 1px}.col-4[_ngcontent-%COMP%], .col-8[_ngcontent-%COMP%]{outline:#00f solid 1px}#output[_ngcontent-%COMP%]{outline:#000 solid 1px}#output[_ngcontent-%COMP%]   .col-gamma[_ngcontent-%COMP%]{display:flex}#output[_ngcontent-%COMP%]   span.content_box[_ngcontent-%COMP%]{display:flex;width:100%}#output[_ngcontent-%COMP%]   span.content_box[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]{line-height:0}.key-active[_ngcontent-%COMP%]{outline:#ff4500 solid 1px}"]],data:{}});function f(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,4,"span",[["class","content_box"]],null,null,null,null,null)),a.Ma(1,278528,null,0,i.l,[a.r,a.k,a.B],{ngStyle:[0,"ngStyle"]},null),a.Xa(2,{width:0}),(l()(),a.Na(3,0,null,null,1,"div",[["class","box"],["style","outline: 1px solid red"]],null,[[null,"click"]],function(l,n,t){var a=!0;return"click"===n&&(a=!1!==l.component.addSprite(l.context.$implicit)&&a),a},null,null)),(l()(),a.Na(4,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],function(l,n){l(n,1,0,l(n,2,0,n.context.$implicit.width+"px"))},function(l,n){l(n,4,0,a.Pa(1,"",n.context.$implicit.result,""))})}function y(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,2,"div",[["class","col-gamma"]],null,null,null,null,null)),(l()(),a.Ea(16777216,null,null,1,null,f)),a.Ma(2,278528,null,0,i.i,[a.M,a.J,a.q],{ngForOf:[0,"ngForOf"]},null)],function(l,n){l(n,2,0,n.context.$implicit)},null)}function v(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,4,"div",[["class","keys-name"]],null,null,null,null,null)),(l()(),a.Na(1,0,null,null,3,"div",[],null,[[null,"dblclick"],[null,"click"]],function(l,n,t){var a=!0,u=l.component;return"dblclick"===n&&(a=!1!==u.changeKeyName(l.context.$implicit.key)&&a),"click"===n&&(a=!1!==u.changeActualKey(l.context.$implicit.key)&&a),a},null,null)),a.Ma(2,278528,null,0,i.h,[a.q,a.r,a.k,a.B],{ngClass:[0,"ngClass"]},null),a.Xa(3,{"key-active":0}),(l()(),a.ab(4,null,[" "," "]))],function(l,n){l(n,2,0,l(n,3,0,n.context.$implicit.key===n.component.actualKey))},function(l,n){l(n,4,0,n.context.$implicit.key)})}function b(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),a.Na(1,0,null,null,0,"img",[],[[8,"src",4]],[[null,"click"]],function(l,n,t){var a=!0;return"click"===n&&(a=!1!==l.component.removeSprite(l.context.$implicit.frame)&&a),a},null,null))],null,function(l,n){l(n,1,0,a.Pa(1,"",n.context.$implicit.result,""))})}function C(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,54,"div",[["class","container"]],null,null,null,null,null)),(l()(),a.Na(1,0,null,null,10,"div",[["class","row"]],null,null,null,null,null)),(l()(),a.Na(2,0,null,null,6,"div",[["class","col-6"]],null,null,null,null,null)),(l()(),a.ab(-1,null,[" Spritesheet "])),(l()(),a.Na(4,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),a.Na(5,0,null,null,3,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),a.Na(6,0,null,null,2,"div",[["id","output"]],null,null,null,null,null)),(l()(),a.Ea(16777216,null,null,1,null,y)),a.Ma(8,278528,null,0,i.i,[a.M,a.J,a.q],{ngForOf:[0,"ngForOf"]},null),(l()(),a.Na(9,0,null,null,2,"div",[["class","col-6"]],null,null,null,null,null)),(l()(),a.ab(-1,null,[" Anim "])),(l()(),a.Na(11,0,null,null,0,"div",[["id","container_phaser"]],null,null,null,null,null)),(l()(),a.Na(12,0,null,null,42,"div",[["class","row"]],null,null,null,null,null)),(l()(),a.Na(13,0,null,null,10,"div",[["class","col-4"]],null,null,null,null,null)),(l()(),a.Na(14,0,null,null,1,"h4",[],null,null,null,null,null)),(l()(),a.ab(-1,null,["Panel"])),(l()(),a.Ea(16777216,null,null,1,null,v)),a.Ma(17,278528,null,0,i.i,[a.M,a.J,a.q],{ngForOf:[0,"ngForOf"]},null),(l()(),a.Na(18,0,null,null,5,"div",[["class","row"]],null,null,null,null,null)),(l()(),a.Na(19,0,null,null,4,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),a.Na(20,0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],function(l,n,t){var a=!0;return"click"===n&&(a=!1!==l.component.addRemoveKey("add")&&a),a},null,null)),(l()(),a.ab(-1,null,["+"])),(l()(),a.Na(22,0,null,null,1,"button",[["class","btn btn-primary ml-3"]],null,[[null,"click"]],function(l,n,t){var a=!0;return"click"===n&&(a=!1!==l.component.addRemoveKey("remove")&&a),a},null,null)),(l()(),a.ab(-1,null,["-"])),(l()(),a.Na(24,0,null,null,30,"div",[["class","col-8"]],null,null,null,null,null)),(l()(),a.ab(-1,null,[" Key controls "])),(l()(),a.Na(26,0,null,null,28,"div",[["class","row"]],null,null,null,null,null)),(l()(),a.Na(27,0,null,null,27,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),a.ab(-1,null,[" output: "])),(l()(),a.Ea(16777216,null,null,1,null,b)),a.Ma(30,278528,null,0,i.i,[a.M,a.J,a.q],{ngForOf:[0,"ngForOf"]},null),(l()(),a.Na(31,0,null,null,20,"div",[["class","controls"]],null,null,null,null,null)),(l()(),a.Na(32,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),a.Na(33,0,null,null,1,"label",[["for","repeatControl"]],null,null,null,null,null)),(l()(),a.ab(-1,null,["Repeat: "])),(l()(),a.Na(35,0,null,null,6,"input",[["id","repeatControl"],["min","-1"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0,e=l.component;return"input"===n&&(u=!1!==a.Wa(l,36)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==a.Wa(l,36).onTouched()&&u),"compositionstart"===n&&(u=!1!==a.Wa(l,36)._compositionStart()&&u),"compositionend"===n&&(u=!1!==a.Wa(l,36)._compositionEnd(t.target.value)&&u),"change"===n&&(u=!1!==a.Wa(l,37).onChange(t.target.value)&&u),"input"===n&&(u=!1!==a.Wa(l,37).onChange(t.target.value)&&u),"blur"===n&&(u=!1!==a.Wa(l,37).onTouched()&&u),"ngModelChange"===n&&(u=!1!==(e.repeatControl=t)&&u),"change"===n&&(u=!1!==e.updateAnimsControls()&&u),u},null,null)),a.Ma(36,16384,null,0,o.b,[a.B,a.k,[2,o.a]],null,null),a.Ma(37,16384,null,0,o.i,[a.B,a.k],null,null),a.Ya(1024,null,o.d,function(l,n){return[l,n]},[o.b,o.i]),a.Ma(39,671744,null,0,o.g,[[8,null],[8,null],[8,null],[6,o.d]],{model:[0,"model"]},{update:"ngModelChange"}),a.Ya(2048,null,o.e,null,[o.g]),a.Ma(41,16384,null,0,o.f,[[4,o.e]],null,null),(l()(),a.Na(42,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),a.Na(43,0,null,null,1,"label",[["for","rateControl"]],null,null,null,null,null)),(l()(),a.ab(-1,null,["Frame Rate: "])),(l()(),a.Na(45,0,null,null,6,"input",[["id","rateControl"],["min","1"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0,e=l.component;return"input"===n&&(u=!1!==a.Wa(l,46)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==a.Wa(l,46).onTouched()&&u),"compositionstart"===n&&(u=!1!==a.Wa(l,46)._compositionStart()&&u),"compositionend"===n&&(u=!1!==a.Wa(l,46)._compositionEnd(t.target.value)&&u),"change"===n&&(u=!1!==a.Wa(l,47).onChange(t.target.value)&&u),"input"===n&&(u=!1!==a.Wa(l,47).onChange(t.target.value)&&u),"blur"===n&&(u=!1!==a.Wa(l,47).onTouched()&&u),"ngModelChange"===n&&(u=!1!==(e.frameRateControl=t)&&u),"change"===n&&(u=!1!==e.updateAnimsControls()&&u),u},null,null)),a.Ma(46,16384,null,0,o.b,[a.B,a.k,[2,o.a]],null,null),a.Ma(47,16384,null,0,o.i,[a.B,a.k],null,null),a.Ya(1024,null,o.d,function(l,n){return[l,n]},[o.b,o.i]),a.Ma(49,671744,null,0,o.g,[[8,null],[8,null],[8,null],[6,o.d]],{model:[0,"model"]},{update:"ngModelChange"}),a.Ya(2048,null,o.e,null,[o.g]),a.Ma(51,16384,null,0,o.f,[[4,o.e]],null,null),(l()(),a.Na(52,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),a.Na(53,0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],function(l,n,t){var a=!0;return"click"===n&&(a=!1!==l.component.generateAnim()&&a),a},null,null)),(l()(),a.ab(-1,null,["Generar"]))],function(l,n){var t=n.component;l(n,8,0,t.imagesFiles),l(n,17,0,t.anims),l(n,30,0,t.actualFrames),l(n,39,0,t.repeatControl),l(n,49,0,t.frameRateControl)},function(l,n){l(n,35,0,a.Wa(n,41).ngClassUntouched,a.Wa(n,41).ngClassTouched,a.Wa(n,41).ngClassPristine,a.Wa(n,41).ngClassDirty,a.Wa(n,41).ngClassValid,a.Wa(n,41).ngClassInvalid,a.Wa(n,41).ngClassPending),l(n,45,0,a.Wa(n,51).ngClassUntouched,a.Wa(n,51).ngClassTouched,a.Wa(n,51).ngClassPristine,a.Wa(n,51).ngClassDirty,a.Wa(n,51).ngClassValid,a.Wa(n,51).ngClassInvalid,a.Wa(n,51).ngClassPending)})}var k=a.Ja("app-animator",g,function(l){return a.bb(0,[(l()(),a.Na(0,0,null,null,1,"app-animator",[],null,null,null,C,d)),a.Ma(1,114688,null,0,g,[s.b,r.a,m.k],null,null)],function(l,n){l(n,1,0)},null)},{},{},[]),N=function(){};t.d(n,"AnimatorModuleNgFactory",function(){return M});var M=a.Ka(u,[],function(l){return a.Ua([a.Va(512,a.j,a.Z,[[8,[e.a,k]],[3,a.j],a.v]),a.Va(4608,s.b,s.b,[]),a.Va(4608,s.c,s.c,[]),a.Va(4608,s.a,s.a,[]),a.Va(4608,s.d,s.d,[]),a.Va(4608,i.k,i.j,[a.s,[2,i.r]]),a.Va(4608,o.j,o.j,[]),a.Va(1073742336,s.e,s.e,[]),a.Va(1073742336,i.b,i.b,[]),a.Va(1073742336,m.l,m.l,[[2,m.r],[2,m.k]]),a.Va(1073742336,N,N,[]),a.Va(1073742336,o.h,o.h,[]),a.Va(1073742336,o.c,o.c,[]),a.Va(1073742336,u,u,[]),a.Va(1024,m.i,function(){return[[{path:"",component:g}]]},[])])})}}]);